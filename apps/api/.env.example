# ==============================================================================
# Workscript API - Environment Configuration Template
# ==============================================================================
#
# IMPORTANT SECURITY NOTES:
# 1. NEVER commit your actual .env file to git (it should be in .gitignore)
# 2. Only commit .env.example with placeholder values
# 3. Generate strong secrets for production (see instructions below)
# 4. Rotate secrets periodically (every 90 days recommended)
# 5. Never log or print secrets
#
# HOW TO USE:
# 1. Copy this file: cp .env.example .env
# 2. Replace all placeholder values with actual values
# 3. Generate secure secrets using the commands provided below
#
# ==============================================================================

# ==============================================================================
# Database Configuration
# ==============================================================================

DB_HOST="localhost"
DB_PORT="3306"
DB_USER="root"
DB_PASSWORD="your-database-password-change-this"  # CHANGE THIS!

DB_NAME="workscript"

# ==============================================================================
# Server Configuration
# ==============================================================================

PORT=3013
SERVER_ID="workscript-api"

# Environment: development | production | test
NODE_ENV="development"

# ==============================================================================
# Google OAuth Configuration (Optional)
# ==============================================================================
# Get these from: https://console.cloud.google.com/apis/credentials

GOOGLE_CLIENT_ID="your-google-client-id-from-console"
GOOGLE_CLIENT_SECRET="your-google-client-secret-from-console"
GOOGLE_REDIRECT_URI="http://localhost:3013/api/auth/google/callback"

# ==============================================================================
# Session Configuration
# ==============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

SESSION_SECRET="REPLACE-WITH-32-CHAR-RANDOM-STRING-FROM-COMMAND-ABOVE"

# ==============================================================================
# Authentication & Authorization Configuration
# ==============================================================================

# JWT Configuration
# These should be long, random strings (minimum 32 characters required)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# SECURITY: Use different secrets for access and refresh tokens!

JWT_SECRET="REPLACE-WITH-32-CHAR-RANDOM-STRING-CHANGE-IN-PRODUCTION"
JWT_REFRESH_SECRET="REPLACE-WITH-DIFFERENT-32-CHAR-RANDOM-STRING-CHANGE-IN-PRODUCTION"

# Token Expiry Times (in seconds)
JWT_ACCESS_EXPIRY=900         # 15 minutes - short-lived for security
JWT_REFRESH_EXPIRY=604800     # 7 days - allows refresh without re-login

# ==============================================================================
# Session Storage Configuration
# ==============================================================================
# Redis is optional - if not set, will use in-memory session storage
# For production, use Redis for distributed session management
#
# Redis URL format: redis://username:password@host:port
# Local Redis: redis://localhost:6379
# Redis Cloud: redis://user:pass@redis-12345.cloud.redislabs.com:12345

REDIS_URL="redis://localhost:6379"
SESSION_EXPIRY=86400          # 24 hours

# ==============================================================================
# Password Reset Configuration
# ==============================================================================

PASSWORD_RESET_EXPIRY=1800           # 30 minutes - security best practice
PASSWORD_RESET_TOKEN_LENGTH=64       # 256 bits in hex = 64 chars

# ==============================================================================
# API Key Configuration
# ==============================================================================

API_KEY_RATE_LIMIT=1000       # Requests per hour per API key
API_KEY_EXPIRY=2592000        # 30 days (in seconds), 0 = never expires

# ==============================================================================
# Security Configuration
# ==============================================================================

# Bcrypt rounds - Higher = more secure but slower
# Recommended: 10 for development, 12+ for production
BCRYPT_ROUNDS=10

# Account Security
MAX_LOGIN_ATTEMPTS=5          # Failed attempts before account lockout
LOCKOUT_DURATION=900          # 15 minutes lockout duration (in seconds)

# ==============================================================================
# CORS Configuration
# ==============================================================================
# Set to your frontend URL(s) in production
# For multiple origins: "http://localhost:5173,https://app.example.com"

CLIENT_URL="http://localhost:5173"

# ==============================================================================
# Email Configuration (for password reset and email verification)
# ==============================================================================
# NOTE: Currently using MOCK email service (logs to console)
# To enable real SMTP emails, implement SMTPEmailService and uncomment below
#
# Password Reset Flow:
# 1. User requests reset → POST /password-reset/request
# 2. System sends email with token (expires in 30 min)
# 3. User clicks link → validates with POST /password-reset/validate
# 4. User enters new password → POST /password-reset/complete
#
# Email Verification Flow:
# 1. User registers → receives verification email (expires in 24 hours)
# 2. User clicks link → GET /auth/verify-email/:token
# 3. Email marked as verified
#
# For Gmail:
# 1. Enable 2-factor authentication
# 2. Generate an App Password: https://myaccount.google.com/apppasswords
# 3. Use the app password below

# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=true                    # Use TLS
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-gmail-app-password   # NOT your regular password!
# EMAIL_FROM=noreply@yourapp.com

# Email Expiry Settings
# EMAIL_VERIFICATION_EXPIRY=86400     # 24 hours (already hardcoded in AuthManager)
# PASSWORD_RESET_EXPIRY=1800          # 30 minutes (already hardcoded in AuthManager)

# ==============================================================================
# Rate Limiting Configuration (Optional)
# ==============================================================================
# In-memory rate limiter settings (for development)
# For production, use Redis-backed rate limiting (configured above)

# RATE_LIMIT_WINDOW=3600              # Time window in seconds (1 hour)
# RATE_LIMIT_MAX_REQUESTS=100         # Max requests per window per IP

# ==============================================================================
# DEPLOYMENT INSTRUCTIONS
# ==============================================================================
#
# For Vercel:
# - Go to Settings → Environment Variables
# - Add each variable above with production values
#
# For Railway:
# - Go to Settings → Variables
# - Add each variable above with production values
#
# For AWS:
# - Use AWS Secrets Manager or CloudFormation Parameters
# - Reference secrets in your deployment configuration
#
# For Docker:
# - Use --env-file flag: docker run --env-file .env.production
# - Or add to docker-compose.yml environment section
#
# ==============================================================================
# SECRET GENERATION COMMANDS
# ==============================================================================
#
# Generate a 32-character random secret:
# $ node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# Or using openssl:
# $ openssl rand -hex 32
#
# Or using Bun:
# $ bun run -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# REMEMBER: Generate different secrets for each variable!
#
# ==============================================================================
