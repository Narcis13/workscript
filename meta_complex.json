{
  "id": "workflow-generator",
  "name": "Meta-Workflow Generator",
  "version": "1.0.0",
  "description": "AI-powered workflow generator that creates production-ready Workscript workflows from natural language requirements. Uses the Reflection API for up-to-date node documentation, multi-step validation, and retry logic for robustness.",
  "initialState": {
    "userRequest": "",
    "model": "anthropic/claude-sonnet-4.5",
    "apiBaseUrl": "http://localhost:3013",
    "retryCount": 0,
    "maxRetries": 3,
    "generationComplete": false,
    "nodeDocumentation": "",
    "currentPrompt": "",
    "aiResponse": "",
    "cleanedResponse": "",
    "parsedJson": null,
    "generatedWorkflow": null,
    "lastError": null,
    "savedWorkflow": null,
    "saveSuccess": false,
    "saveError": null,
    "result": null
  },
  "workflow": [
    {
      "fetchApi": {
        "url": "{{$.apiBaseUrl}}/workscript/reflection/manifest/compact",
        "method": "GET",
        "headers": {
          "Authorization": "Bearer {{$.JWT_token}}",
          "Content-Type": "application/json"
        },
        "timeout": 10000,
        "success?": {
          "editFields": {
            "mode": "manual_mapping",
            "fieldsToSet": [
              {
                "name": "nodeDocumentation",
                "value": "$.fetchResponse.systemPrompt",
                "type": "string"
              }
            ],
            "success?": {
              "log": {
                "message": "Successfully fetched node documentation from Reflection API"
              }
            }
          }
        },
        "error?": {
          "editFields": {
            "mode": "manual_mapping",
            "fieldsToSet": [
              {
                "name": "nodeDocumentation",
                "value": "Use your general knowledge of Workscript workflow syntax. Available node types include: math, logic, transform, log, empty, filter, sort, aggregate, switch, splitOut, limit, editFields, summarize, transformObject, jsonExtract, removeDuplicates, validateData, compareDatasets, dateTime, stringOperations, mathOperations, arrayUtilities, objectUtilities, extractText, calculateField, ask-ai, runWorkflow, filesystem, database, auth, fetchApi. Follow the standard workflow JSON structure with id, name, version, and workflow array.",
                "type": "string"
              }
            ],
            "success?": {
              "log": {
                "message": "Using fallback node documentation - Reflection API unavailable"
              }
            }
          }
        },
        "clientError?": {
          "editFields": {
            "mode": "manual_mapping",
            "fieldsToSet": [
              {
                "name": "nodeDocumentation",
                "value": "Use your general knowledge of Workscript workflow syntax. Available node types include: math, logic, transform, log, empty, filter, sort, aggregate, switch, splitOut, limit, editFields, summarize, transformObject, jsonExtract, removeDuplicates, validateData, compareDatasets, dateTime, stringOperations, mathOperations, arrayUtilities, objectUtilities, extractText, calculateField, ask-ai, runWorkflow, filesystem, database, auth, fetchApi. Follow the standard workflow JSON structure with id, name, version, and workflow array.",
                "type": "string"
              }
            ],
            "success?": {
              "log": {
                "message": "Using fallback node documentation - API returned client error (possibly invalid JWT)"
              }
            }
          }
        },
        "serverError?": {
          "editFields": {
            "mode": "manual_mapping",
            "fieldsToSet": [
              {
                "name": "nodeDocumentation",
                "value": "Use your general knowledge of Workscript workflow syntax. Available node types include: math, logic, transform, log, empty, filter, sort, aggregate, switch, splitOut, limit, editFields, summarize, transformObject, jsonExtract, removeDuplicates, validateData, compareDatasets, dateTime, stringOperations, mathOperations, arrayUtilities, objectUtilities, extractText, calculateField, ask-ai, runWorkflow, filesystem, database, auth, fetchApi. Follow the standard workflow JSON structure with id, name, version, and workflow array.",
                "type": "string"
              }
            ],
            "success?": {
              "log": {
                "message": "Using fallback node documentation - server error from Reflection API"
              }
            }
          }
        }
      }
    }

  ]
}
